!function t(r,e,n){function o(a,s){if(!e[a]){if(!r[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var f=e[a]={exports:{}};r[a][0].call(f.exports,function(t){var e=r[a][1][t];return o(e?e:t)},f,f.exports,t,r,e,n)}return e[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,r,e){"use strict";function n(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function o(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(t.__proto__=r)}var i=function(){function t(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(r,e,n){return e&&t(r.prototype,e),n&&t(r,n),r}}(),a=function(t,r,e){for(var n=!0;n;){var o=t,i=r,a=e;s=u=l=void 0,n=!1;var s=Object.getOwnPropertyDescriptor(o,i);if(void 0!==s){if("value"in s)return s.value;var l=s.get;return void 0===l?void 0:l.call(a)}var u=Object.getPrototypeOf(o);if(null===u)return void 0;t=u,r=i,e=a,n=!0}},s=t("hls"),l=t("browser"),u=(t("./jst"),function(t){function r(t){n(this,r),a(Object.getPrototypeOf(r.prototype),"constructor",this).call(this,t),this.playlistXhr=null,this.fragmentXhr=null,this.firstPlayStartPosition=peer5.getConfig("MEDIA_LIVE_START_POS")||0,this.maxBufferLength=peer5.getConfig("MEDIA_MAXBUFFER")||30}return o(r,t),i(r,[{key:"name",get:function(){return"hls"}},{key:"addListeners",value:function(){var t=this;a(Object.getPrototypeOf(r.prototype),"addListeners",this).call(this),Clappr.Mediator.on(this.cid+":error",function(r,e,n){return t.onError(r,e,n)}),Clappr.Mediator.on(this.cid+":requestplaylist",function(r,e,n,o){return t.onPlaylistRequest(r,e,n,o)}),Clappr.Mediator.on(this.cid+":abortplaylist",function(r){return t.onPlaylistAbort(r)}),Clappr.Mediator.on(this.cid+":requestfragment",function(r,e,n,o){return t.onFragmentRequest(r,e,n,o)}),Clappr.Mediator.on(this.cid+":abortfragment",function(r){return t.onFragmentAbort(r)})}},{key:"stopListening",value:function(){a(Object.getPrototypeOf(r.prototype),"stopListening",this).call(this),Clappr.Mediator.off(this.cid+":error"),Clappr.Mediator.off(this.cid+":requestplaylist"),Clappr.Mediator.off(this.cid+":abortplaylist"),Clappr.Mediator.off(this.cid+":requestfragment"),Clappr.Mediator.off(this.cid+":abortfragment")}},{key:"onError",value:function(t,r,e){console.error("flashls error:",t,r,e)}},{key:"onPlaylistRequest",value:function(t,r,e,n){var o=this;this.playlistXhr=new peer5.Request,this.playlistXhr.open("GET",r),this.playlistXhr.responseType="text",this.playlistXhr.onload=function(t){return t.currentTarget.response?(o.playlistXhr=null,o.el[e](t.currentTarget.response)):(o.playlistXhr=null,o.el[n]())},this.playlistXhr.onerror=this.playlistXhr.onabort=function(t){return o.playlistXhr=null,o.el[n]()},this.playlistXhr.send()}},{key:"onPlaylistAbort",value:function(t){this.playlistXhr&&this.playlistXhr.abort()}},{key:"onFragmentRequest",value:function(t,r,e,n){var o=this;this.fragmentXhr=new peer5.Request,this.fragmentXhr.open("GET",r),this.fragmentXhr.responseType="arraybuffer",this.fragmentXhr.onload=function(t){if(!t.currentTarget.response)return o.fragmentXhr=null,o.el[n]();var r=o.arrayBufferToBase64(t.currentTarget.response),i=t.currentTarget.response.byteLength;return o.fragmentXhr=null,o.el[e](r,i)},this.fragmentXhr.onerror=this.fragmentXhr.onabort=function(t){return o.fragmentXhr=null,o.el[n]()},this.fragmentXhr.send()}},{key:"onFragmentAbort",value:function(t){this.fragmentXhr&&this.fragmentXhr.abort()}},{key:"arrayBufferToBase64",value:function(t){for(var r=new Uint8Array(t),e="",n=0,o=r.length;o>n;n++)e+=String.fromCharCode(r[n]);return window.btoa(e)}},{key:"setFlashSettings",value:function(){a(Object.getPrototypeOf(r.prototype),"setFlashSettings",this).call(this),this.el.playerSetJSURLStream(!0),this.el.playerSetmaxBufferLength(this.maxBufferLength)}},{key:"firstPlay",value:function(){var t=this;this.setFlashSettings(),this.el.playerLoad(this.src),Clappr.Mediator.once(this.cid+":manifestloaded",function(){return t.el.playerPlay(t.firstPlayStartPosition)}),this.srcLoaded=!0}}]),r}(s));u.canPlay=function(t,r){return!("undefined"==typeof peer5||!window.webkitRTCPeerConnection&&!window.mozRTCPeerConnection||!l.hasFlash||!window.btoa||!t.match(/^http(.*).m3u8?/)&&"application/x-mpegURL"!==r)},r.exports=window.Peer5Playback=u},{"./jst":2,browser:"browser",hls:"hls"}],2:[function(t,r,e){"use strict";t("template");r.exports={CSS:{}}},{template:"template"}]},{},[1]);