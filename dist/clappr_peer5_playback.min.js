!function t(e,r,n){function o(a,s){if(!r[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[a]={exports:{}};e[a][0].call(c.exports,function(t){var r=e[a][1][t];return o(r?r:t)},c,c.exports,t,e,r,n)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)}var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=function(t,e,r){for(var n=!0;n;){var o=t,i=e,a=r;s=u=l=void 0,n=!1;var s=Object.getOwnPropertyDescriptor(o,i);if(void 0!==s){if("value"in s)return s.value;var l=s.get;return void 0===l?void 0:l.call(a)}var u=Object.getPrototypeOf(o);if(null===u)return void 0;t=u,e=i,r=a,n=!0}},s=t("hls"),l=t("browser"),u=(t("./jst"),function(t){function e(t){n(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.playlistXhr=null,this.fragmentXhr=null}return o(e,t),i(e,[{key:"name",get:function(){return"hls"}},{key:"addListeners",value:function(){var t=this;a(Object.getPrototypeOf(e.prototype),"addListeners",this).call(this),Clappr.Mediator.on(this.cid+":error",function(e){return t.onError(e.code,e.url,e.message)}),Clappr.Mediator.on(this.cid+":playlistrequest",function(e){return t.onPlaylistRequest(e.objectId,e.url,e.callbackLoaded,e.callbackFailure)}),Clappr.Mediator.on(this.cid+":playlistabort",function(e){return t.onPlaylistAbort(e)}),Clappr.Mediator.on(this.cid+":fragmentrequest",function(e){return t.onFragmentRequest(e.objectId,e.url,e.callbackLoaded,e.callbackFailure)}),Clappr.Mediator.on(this.cid+":fragmentabort",function(e){return t.onFragmentAbort(e)})}},{key:"stopListening",value:function(){a(Object.getPrototypeOf(e.prototype),"stopListening",this).call(this),Clappr.Mediator.off(this.cid+":requestplaylist"),Clappr.Mediator.off(this.cid+":abortplaylist"),Clappr.Mediator.off(this.cid+":requestfragment"),Clappr.Mediator.off(this.cid+":abortfragment")}},{key:"onError",value:function(t,e,r){console.error("flashls error:",t,e,r)}},{key:"onPlaylistRequest",value:function(t,e,r,n){var o=this;this.playlistXhr=new peer5.Request,this.playlistXhr.open("GET",e),this.playlistXhr.responseType="text",this.playlistXhr.onload=function(t){return t.currentTarget.response?o.el[r](t.currentTarget.response):o.el[n]()},this.playlistXhr.onerror=this.playlistXhr.onabort=function(t){return o.el[n]()},this.playlistXhr.send()}},{key:"onPlaylistAbort",value:function(t){this.playlistXhr&&this.playlistXhr.abort()}},{key:"onFragmentRequest",value:function(t,e,r,n){var o=this;this.fragmentXhr=new peer5.Request,this.fragmentXhr.open("GET",e),this.fragmentXhr.responseType="arraybuffer",this.fragmentXhr.onload=function(t){if(!t.currentTarget.response)return o.el[n]();var e=o.arrayBufferToBase64(t.currentTarget.response),i=t.currentTarget.response.byteLength;return o.el[r](e,i)},this.fragmentXhr.onerror=this.fragmentXhr.onabort=function(t){o.el[n]()},this.fragmentXhr.send()}},{key:"arrayBufferToBase64",value:function(t){for(var e=new Uint8Array(t),r="",n=0,o=e.length;o>n;n++)r+=String.fromCharCode(e[n]);return window.btoa(r)}},{key:"onFragmentAbort",value:function(t){this.fragmentXhr&&this.fragmentXhr.abort()}},{key:"setFlashSettings",value:function(){a(Object.getPrototypeOf(e.prototype),"setFlashSettings",this).call(this),this.el.playerSetJSURLStream(!0)}}]),e}(s));u.canPlay=function(t){return!("undefined"==typeof peer5||!window.webkitRTCPeerConnection&&!window.mozRTCPeerConnection||!l.hasFlash||!window.btoa||!t.match(/^http(.*).m3u8?/)&&"application/x-mpegURL"!==mimeType)},e.exports=window.ClapprPeer5Playback=u},{"./jst":2,browser:"browser",hls:"hls"}],2:[function(t,e,r){"use strict";t("template");e.exports={CSS:{}}},{template:"template"}]},{},[1]);